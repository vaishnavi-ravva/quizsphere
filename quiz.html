<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QuizSphere | Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== UI (UNCHANGED) ===== */
html,body{width:100%;height:100%;margin:0;}
body{
  font-family:Arial, Helvetica, sans-serif;
  background:linear-gradient(to right,#141E30,#243B55);
  display:flex;justify-content:center;align-items:stretch;
  overflow:hidden;
}
body.light{background:linear-gradient(to right,#f5f7fa,#e4ebf5);}

.quiz-box{
  background:#fff;width:100%;height:100%;
  padding:25px;box-sizing:border-box;
  display:flex;flex-direction:column;
}
.header{display:flex;justify-content:space-between;font-weight:bold;}
.timer{color:#d32f2f;}

.tools{
  position:fixed;top:10px;right:10px;
  display:flex;flex-direction:column;gap:8px;z-index:1000;
}
.tools button{border:none;padding:6px 10px;border-radius:6px;cursor:pointer;}

.status-box{
  display:flex;justify-content:space-around;
  background:#f5f5f5;padding:10px;border-radius:8px;
  margin:12px 0;font-size:13px;
}

.question-box{padding:12px;}
.question-box.marked{background:#fff3e0;border-left:6px solid #ff9800;}

.options button{
  width:100%;padding:12px;margin-bottom:10px;
  border-radius:8px;border:2px solid #ddd;
  cursor:pointer;background:#f5f5f5;
}
.options button.selected{background:#bbdefb;border-color:#1976d2;}

.controls{display:flex;gap:10px;margin-top:auto;}
.controls button{
  flex:1;padding:12px;border:none;border-radius:8px;
  font-weight:bold;cursor:pointer;
}
.prev{background:#bdbdbd;}
.next{background:#64b5f6;}
.mark{background:#ffcc80;}
.submit{background:#2e7d32;color:#fff;display:none;}

.result-box{
  background:#fff;max-width:900px;width:90%;
  padding:25px;border-radius:14px;
  box-shadow:0 20px 40px rgba(0,0,0,0.4);
  margin:40px auto;
}
.wrong{background:#ffebee;padding:12px;border-left:5px solid #d32f2f;margin-bottom:10px;}
.correct{color:#2e7d32;font-weight:bold;}
</style>
</head>

<body>

<div class="tools">
  <!-- Theme toggle -->
  <button onclick="toggleTheme()" title="Toggle Theme">üåô</button>

  <!-- Info button -->
  <button onclick="showInfo()" title="Quiz Info">‚ÑπÔ∏è</button>
</div>


<div class="quiz-box" id="quizBox">

  <div class="header">
    <div id="qNo"></div>
    <div class="timer" id="timer"></div>
  </div>

  <div class="status-box">
    <div>Attempted: <span id="attempted">0</span></div>
    <div>Not Attempted: <span id="notAttempted">10</span></div>
    <div>Marked: <span id="markedCount">0</span></div>
  </div>

  <div id="questionBox" class="question-box">
    <h3 id="question"></h3>
  </div>

  <div class="options" id="options"></div>

  <div class="controls">
    <button class="prev" onclick="prevQ()">Previous</button>
    <button class="mark" onclick="markQ()">Mark</button>
    <button class="next" onclick="nextQ()">Next</button>
    <button class="submit" id="submitBtn" onclick="submitQuiz()">Submit</button>
  </div>

</div>

<script>
/* ===== GUARDS ===== */
if(!localStorage.getItem("qs_user")) location.href="login.html";
if(!localStorage.getItem("qs_domain")) location.href="domain.html";

/* ===== THEME ===== */
function toggleTheme(){
  const l=document.body.classList.toggle("light");
  localStorage.setItem("qs_theme",l?"light":"dark");
}
if(localStorage.getItem("qs_theme")==="light"){
  document.body.classList.add("light");
}

/* ===== INFO ===== */
function showInfo(){
  alert(`Quiz Rules:
‚Ä¢ 10 questions per domain
‚Ä¢ Submit only after all answered
‚Ä¢ Mark highlights questions
‚Ä¢ Practice: No timer
‚Ä¢ Challenge: 10 minutes
‚Ä¢ Tab switch auto-submit
‚Ä¢ 10/10 ‚Üí ‚Çπ500 + Certificate`);
}

/* ===== FULL QUESTION BANK (ALL DOMAINS, 10 EACH) ===== */
const QB = {
  cse:[
    {q:"CPU stands for?",o:["Central Processing Unit","Control Program","Core Unit","None"],a:0},
    {q:"RAM is?",o:["Permanent","Volatile","Secondary","None"],a:1},
    {q:"HTML is?",o:["Markup Language","Programming","OS","None"],a:0},
    {q:"Binary number system base?",o:["2","8","10","16"],a:0},
    {q:"CSS is used for?",o:["Styling","Logic","Database","None"],a:0},
    {q:"Python is?",o:["Programming Language","OS","Browser","None"],a:0},
    {q:"DBMS stands for?",o:["Database Management System","Data Binary","None","None"],a:0},
    {q:"HTTP is a?",o:["Protocol","Language","OS","None"],a:0},
    {q:"IP stands for?",o:["Internet Protocol","Internal Process","None","None"],a:0},
    {q:"Windows is an?",o:["Operating System","Language","CPU","None"],a:0}
  ],

  ece:[
    {q:"IC stands for?",o:["Integrated Circuit","Internal Chip","None","None"],a:0},
    {q:"Frequency unit?",o:["Hz","Volt","Amp","None"],a:0},
    {q:"Diode allows current?",o:["One direction","Both directions","None","None"],a:0},
    {q:"Capacitor stores?",o:["Charge","Current","Voltage","None"],a:0},
    {q:"AND gate outputs 1 when?",o:["All inputs are 1","Any input is 1","None","None"],a:0},
    {q:"Microprocessor brain?",o:["CPU","RAM","ROM","None"],a:0},
    {q:"Ohm is unit of?",o:["Resistance","Voltage","Current","None"],a:0},
    {q:"Logic gates are?",o:["Digital","Analog","Hybrid","None"],a:0},
    {q:"AC means?",o:["Alternating Current","Active Current","None","None"],a:0},
    {q:"Transistor is used for?",o:["Amplification","Storage","Heating","None"],a:0}
  ],

  eee:[
    {q:"Current unit?",o:["Ampere","Volt","Ohm","None"],a:0},
    {q:"Transformer works on?",o:["AC","DC","Both","None"],a:0},
    {q:"Power unit?",o:["Watt","Joule","Volt","None"],a:0},
    {q:"Battery supplies?",o:["DC","AC","Both","None"],a:0},
    {q:"Resistance unit?",o:["Ohm","Volt","Amp","None"],a:0},
    {q:"Motor converts?",o:["Electrical to Mechanical","Mechanical to Electrical","None","None"],a:0},
    {q:"Generator converts?",o:["Mechanical to Electrical","Electrical to Heat","None","None"],a:0},
    {q:"Fuse is used for?",o:["Protection","Storage","Control","None"],a:0},
    {q:"Power formula?",o:["VI","IR","V/R","None"],a:0},
    {q:"Earth wire color?",o:["Green","Red","Blue","None"],a:0}
  ],

  civil:[
    {q:"RCC stands for?",o:["Reinforced Cement Concrete","Road Construction","None","None"],a:0},
    {q:"Concrete mix ratio?",o:["1:2:4","1:1:1","2:3:4","None"],a:0},
    {q:"Beam resists?",o:["Bending","Tension","None","None"],a:0},
    {q:"Foundation purpose?",o:["Support","Decoration","None","None"],a:0},
    {q:"Brick is made of?",o:["Clay","Sand","Cement","None"],a:0},
    {q:"Cement main ingredient?",o:["Limestone","Sand","Clay","None"],a:0},
    {q:"Surveying measures?",o:["Land","Water","None","None"],a:0},
    {q:"Column resists?",o:["Compression","Tension","None","None"],a:0},
    {q:"DPC prevents?",o:["Moisture","Load","None","None"],a:0},
    {q:"Plaster gives?",o:["Finish","Strength","None","None"],a:0}
  ],

  gk:[
    {q:"Capital of India?",o:["Delhi","Mumbai","Chennai","Kolkata"],a:0},
    {q:"National animal of India?",o:["Tiger","Lion","Elephant","Horse"],a:0},
    {q:"National bird?",o:["Peacock","Crow","Parrot","Eagle"],a:0},
    {q:"Largest ocean?",o:["Pacific","Indian","Atlantic","Arctic"],a:0},
    {q:"Father of the Nation?",o:["Mahatma Gandhi","Nehru","Patel","Bose"],a:0},
    {q:"Currency of India?",o:["Rupee","Dollar","Yen","Euro"],a:0},
    {q:"Taj Mahal located in?",o:["Agra","Delhi","Jaipur","Mumbai"],a:0},
    {q:"Largest continent?",o:["Asia","Africa","Europe","America"],a:0},
    {q:"Indian flag colors?",o:["3","4","5","2"],a:0},
    {q:"National flower?",o:["Lotus","Rose","Lily","None"],a:0}
  ],

  aptitude:[
    {q:"10 + 20 = ?",o:["30","20","40","10"],a:0},
    {q:"5 √ó 6 = ?",o:["30","20","25","40"],a:0},
    {q:"100 / 4 = ?",o:["25","20","30","10"],a:0},
    {q:"Square of 5?",o:["25","10","20","30"],a:0},
    {q:"15% of 200?",o:["30","20","25","40"],a:0},
    {q:"LCM of 2 & 4?",o:["4","2","6","8"],a:0},
    {q:"Cube of 3?",o:["27","9","81","6"],a:0},
    {q:"Average of 2 & 4?",o:["3","2","4","6"],a:0},
    {q:"SI formula?",o:["PTR/100","PRT","PT/R","None"],a:0},
    {q:"Profit formula?",o:["SP - CP","CP - SP","SP + CP","None"],a:0}
  ],

  english:[
    {q:"Plural of child?",o:["Children","Childs","Childes","None"],a:0},
    {q:"Synonym of fast?",o:["Quick","Slow","Late","None"],a:0},
    {q:"Antonym of hot?",o:["Cold","Warm","Heat","None"],a:0},
    {q:"Correct spelling?",o:["Beautiful","Beautifull","Beatiful","None"],a:0},
    {q:"Article for apple?",o:["An","A","The","None"],a:0},
    {q:"Opposite of big?",o:["Small","Large","Huge","None"],a:0},
    {q:"Verb in sentence?",o:["Run","Blue","Fast","None"],a:0},
    {q:"Plural of mouse?",o:["Mice","Mouses","Mouse","None"],a:0},
    {q:"Synonym of happy?",o:["Joyful","Sad","Angry","None"],a:0},
    {q:"Tense of 'is eating'?",o:["Present Continuous","Past","Future","None"],a:0}
  ],

  sports:[
    {q:"Cricket bat made of?",o:["Willow","Plastic","Steel","None"],a:0},
    {q:"Players in football?",o:["11","10","9","12"],a:0},
    {q:"Olympics held every?",o:["4 years","2 years","5 years","None"],a:0},
    {q:"Tennis Grand Slam?",o:["Wimbledon","IPL","FIFA","None"],a:0},
    {q:"World cricket body?",o:["ICC","BCCI","FIFA","None"],a:0},
    {q:"Basketball hoop height?",o:["10 feet","12 feet","8 feet","None"],a:0},
    {q:"Kabaddi originated in?",o:["India","China","Japan","None"],a:0},
    {q:"Chess Grandmaster?",o:["Anand","Sachin","Dhoni","None"],a:0},
    {q:"Badminton shuttle?",o:["Feather","Plastic","Rubber","None"],a:0},
    {q:"National sport of India?",o:["Hockey","Cricket","Football","None"],a:0}
  ],

  movies:[
    {q:"First Indian film?",o:["Raja Harishchandra","Alam Ara","None","None"],a:0},
    {q:"Oscar award relates to?",o:["Movies","Music","Sports","None"],a:0},
    {q:"Titanic director?",o:["James Cameron","Spielberg","None","None"],a:0},
    {q:"Bollywood actor?",o:["Shah Rukh Khan","Messi","Kohli","None"],a:0},
    {q:"Avatar genre?",o:["Sci-Fi","Comedy","Drama","None"],a:0},
    {q:"IMDb full form?",o:["Internet Movie Database","Movie DB","None","None"],a:0},
    {q:"Cinema invented in?",o:["France","USA","India","None"],a:0},
    {q:"Editing stage?",o:["Post-production","Production","Pre-production","None"],a:0},
    {q:"Movie camera brand?",o:["ARRI","Canon","Sony","None"],a:0},
    {q:"Actor performs?",o:["Roles","Songs","Dance","None"],a:0}
  ],

  fun:[
    {q:"Sky color?",o:["Blue","Red","Green","None"],a:0},
    {q:"2 + 2 = ?",o:["4","3","5","None"],a:0},
    {q:"üòÄ emoji means?",o:["Happy","Sad","Angry","None"],a:0},
    {q:"Fastest animal?",o:["Cheetah","Lion","Dog","None"],a:0},
    {q:"Rainbow has colors?",o:["7","5","6","None"],a:0},
    {q:"Opposite of yes?",o:["No","Maybe","Ok","None"],a:0},
    {q:"Sun rises in?",o:["East","West","North","None"],a:0},
    {q:"Ice is?",o:["Cold","Hot","Warm","None"],a:0},
    {q:"Water freezes at?",o:["0¬∞C","10¬∞C","100¬∞C","None"],a:0},
    {q:"Smile is?",o:["Expression","Sound","Food","None"],a:0}
  ]
};

/* ===== QUIZ LOGIC ===== */
const domain = localStorage.getItem("qs_domain");
const mode = localStorage.getItem("qs_mode") || "practice";
const questions = QB[domain];

let index=0, answers=Array(10).fill(null), marked=Array(10).fill(false);
const timerEl=document.getElementById("timer");

let time=600, timer=null;
if(mode==="challenge"){
  timer=setInterval(()=>{
    timerEl.innerText=`Time: ${Math.floor(time/60)}:${String(time%60).padStart(2,"0")}`;
    if(--time<0) submitQuiz();
  },1000);
}else timerEl.innerText="Practice Mode";

function loadQ(){
  qNo.innerText=`Question ${index+1}/10`;
  question.innerText=questions[index].q;
  questionBox.className=marked[index]?"question-box marked":"question-box";
  options.innerHTML="";
  questions[index].o.forEach((o,i)=>{
    const b=document.createElement("button");
    b.innerText=o;
    if(answers[index]===i) b.classList.add("selected");
    b.onclick=()=>{answers[index]=i;updateStatus();loadQ();};
    options.appendChild(b);
  });
  updateStatus();
}

function updateStatus(){
  attempted.innerText=answers.filter(a=>a!==null).length;
  notAttempted.innerText=answers.filter(a=>a===null).length;
  markedCount.innerText=marked.map((m,i)=>m?i+1:null).filter(Boolean).join(",")||0;
  submitBtn.style.display=!answers.includes(null)?"block":"none";
}

function nextQ(){
  if(index===9 && answers.includes(null)){alert("You missed some questions");return;}
  if(index<9){index++;loadQ();}
}
function prevQ(){if(index>0){index--;loadQ();}}
function markQ(){marked[index]=!marked[index];updateStatus();loadQ();}

function submitQuiz(){
  if(timer) clearInterval(timer);
  document.body.style.overflow="auto";
  let score=0, wrongHTML="";
  questions.forEach((q,i)=>{
    if(answers[i]===q.a) score++;
    else wrongHTML+=`
      <div class="wrong">
        <b>Q${i+1}:</b> ${q.q}<br>
        Your Answer: ${answers[i]!=null?q.o[answers[i]]:"Not Answered"}<br>
        <span class="correct">Correct: ${q.o[q.a]}</span>
      </div>`;
  });

  if(mode==="challenge" && score===10){
    localStorage.setItem("qs_certificate",JSON.stringify({
      name:localStorage.getItem("qs_user"),
      domain:domain,
      date:new Date().toLocaleDateString()
    }));
    alert("üéâ Congratulations! You won ‚Çπ500");
    location.href="certificate.html";
    return;
  }

  quizBox.outerHTML=`
    <div class="result-box">
      <h2>Result</h2>
      <p><b>Score: ${score}/10</b></p>
      ${wrongHTML||"<p class='correct'>Perfect Score üéâ</p>"}
      <button onclick="location.href='mode.html'">Back to Mode</button>
    </div>`;
}

document.addEventListener("visibilitychange",()=>{
  if(document.hidden && mode==="challenge") submitQuiz();
});

loadQ();
</script>

</body>
</html>
